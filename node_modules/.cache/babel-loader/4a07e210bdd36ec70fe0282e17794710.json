{"remainingRequest":"/Users/shangjiawei/Desktop/my all/node/blog_h5/node_modules/thread-loader/dist/cjs.js!/Users/shangjiawei/Desktop/my all/node/blog_h5/node_modules/babel-loader/lib/index.js!/Users/shangjiawei/Desktop/my all/node/blog_h5/node_modules/eslint-loader/index.js??ref--13-0!/Users/shangjiawei/Desktop/my all/node/blog_h5/src/config/fetch.js","dependencies":[{"path":"/Users/shangjiawei/Desktop/my all/node/blog_h5/src/config/fetch.js","mtime":1557931292157},{"path":"/Users/shangjiawei/Desktop/my all/node/blog_h5/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shangjiawei/Desktop/my all/node/blog_h5/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/shangjiawei/Desktop/my all/node/blog_h5/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/shangjiawei/Desktop/my all/node/blog_h5/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _typeof from \"/Users/shangjiawei/Desktop/my all/node/blog_h5/node_modules/@babel/runtime-corejs2/helpers/esm/typeof\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/shangjiawei/Desktop/my all/node/blog_h5/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport { baseUrl } from \"./env\";\nexport default\n/*#__PURE__*/\n_asyncToGenerator(\n/*#__PURE__*/\nregeneratorRuntime.mark(function _callee() {\n  var url,\n      data,\n      type,\n      method,\n      dataStr,\n      requestConfig,\n      response,\n      responseJson,\n      _args = arguments;\n  return regeneratorRuntime.wrap(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          url = _args.length > 0 && _args[0] !== undefined ? _args[0] : '';\n          data = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n          type = _args.length > 2 && _args[2] !== undefined ? _args[2] : 'GET';\n          method = _args.length > 3 && _args[3] !== undefined ? _args[3] : 'fetch';\n          // debugger\n          type = type.toUpperCase();\n          url = baseUrl + url;\n\n          if (type == 'GET') {\n            dataStr = ''; //数据拼接字符串\n\n            Object.keys(data).forEach(function (key) {\n              dataStr += key + '=' + data[key] + '&';\n            });\n\n            if (dataStr !== '') {\n              dataStr = dataStr.substr(0, dataStr.lastIndexOf('&'));\n              url = url + '?' + dataStr;\n            }\n          }\n\n          if (!(window.fetch && method == 'fetch')) {\n            _context.next = 25;\n            break;\n          }\n\n          requestConfig = {\n            credentials: 'include',\n            method: type,\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json'\n            },\n            mode: \"cors\",\n            cache: \"force-cache\"\n          };\n\n          if (type == 'POST') {\n            Object.defineProperty(requestConfig, 'body', {\n              value: JSON.stringify(data)\n            });\n          }\n\n          _context.prev = 10;\n          _context.next = 13;\n          return fetch(url, requestConfig);\n\n        case 13:\n          response = _context.sent;\n          _context.next = 16;\n          return response.json();\n\n        case 16:\n          responseJson = _context.sent;\n          return _context.abrupt(\"return\", responseJson);\n\n        case 20:\n          _context.prev = 20;\n          _context.t0 = _context[\"catch\"](10);\n          throw new Error(_context.t0);\n\n        case 23:\n          _context.next = 26;\n          break;\n\n        case 25:\n          return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n            var requestObj;\n\n            if (window.XMLHttpRequest) {\n              requestObj = new XMLHttpRequest();\n            } else {\n              requestObj = new ActiveXObject();\n            }\n\n            var sendData = '';\n\n            if (type == 'POST') {\n              sendData = JSON.stringify(data);\n            }\n\n            requestObj.open(type, url, true);\n            requestObj.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n            requestObj.send(sendData);\n\n            requestObj.onreadystatechange = function () {\n              if (requestObj.readyState == 4) {\n                if (requestObj.status == 200) {\n                  var obj = requestObj.response;\n\n                  if (_typeof(obj) !== 'object') {\n                    obj = JSON.parse(obj);\n                  }\n\n                  resolve(obj);\n                } else {\n                  reject(requestObj);\n                }\n              }\n            };\n          }));\n\n        case 26:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _callee, null, [[10, 20]]);\n}));",{"version":3,"sources":["/Users/shangjiawei/Desktop/my all/node/blog_h5/src/config/fetch.js"],"names":["baseUrl","url","data","type","method","toUpperCase","dataStr","Object","keys","forEach","key","substr","lastIndexOf","window","fetch","requestConfig","credentials","headers","mode","cache","defineProperty","value","JSON","stringify","response","json","responseJson","Error","Promise","resolve","reject","requestObj","XMLHttpRequest","ActiveXObject","sendData","open","setRequestHeader","send","onreadystatechange","readyState","status","obj","parse"],"mappings":"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","sourcesContent":["import {\n\tbaseUrl\n} from './env'\n\nexport default async(url = '', data = {}, type = 'GET', method = 'fetch') => {\n\t// debugger\n\ttype = type.toUpperCase();\n\turl = baseUrl + url;\n\n\tif (type == 'GET') {\n\t\tlet dataStr = ''; //数据拼接字符串\n\t\tObject.keys(data).forEach(key => {\n\t\t\tdataStr += key + '=' + data[key] + '&';\n\t\t})\n\n\t\tif (dataStr !== '') {\n\t\t\tdataStr = dataStr.substr(0, dataStr.lastIndexOf('&'));\n\t\t\turl = url + '?' + dataStr;\n\t\t}\n\t}\n\n\tif (window.fetch && method == 'fetch') {\n\t\tlet requestConfig = {\n\t\t\tcredentials: 'include',\n\t\t\tmethod: type,\n\t\t\theaders: {\n\t\t\t\t'Accept': 'application/json',\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t},\n\t\t\tmode: \"cors\",\n\t\t\tcache: \"force-cache\"\n\t\t}\n\n\t\tif (type == 'POST') {\n\t\t\tObject.defineProperty(requestConfig, 'body', {\n\t\t\t\tvalue: JSON.stringify(data)\n\t\t\t})\n\t\t}\n\t\t\n\t\ttry {\n\t\t\tconst response = await fetch(url, requestConfig);\n\t\t\tconst responseJson = await response.json();\n\t\t\treturn responseJson\n\t\t} catch (error) {\n\t\t\tthrow new Error(error)\n\t\t}\n\t} else {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet requestObj;\n\t\t\tif (window.XMLHttpRequest) {\n\t\t\t\trequestObj = new XMLHttpRequest();\n\t\t\t} else {\n\t\t\t\trequestObj = new ActiveXObject;\n\t\t\t}\n\n\t\t\tlet sendData = '';\n\t\t\tif (type == 'POST') {\n\t\t\t\tsendData = JSON.stringify(data);\n\t\t\t}\n\n\t\t\trequestObj.open(type, url, true);\n\t\t\trequestObj.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n\t\t\trequestObj.send(sendData);\n\n\t\t\trequestObj.onreadystatechange = () => {\n\t\t\t\tif (requestObj.readyState == 4) {\n\t\t\t\t\tif (requestObj.status == 200) {\n\t\t\t\t\t\tlet obj = requestObj.response\n\t\t\t\t\t\tif (typeof obj !== 'object') {\n\t\t\t\t\t\t\tobj = JSON.parse(obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(obj)\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(requestObj)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n}"]}]}